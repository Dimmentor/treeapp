#asyncio

## üîç –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–ó–∞—á–µ–º –Ω–∞–º –Ω—É–∂–µ–Ω asyncio](#1-–∑–∞—á–µ–º-–Ω–∞–º-–Ω—É–∂–µ–Ω-asyncio)

2. [–ß—Ç–æ —Ç–∞–∫–æ–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥](#2-—á—Ç–æ-—Ç–∞–∫–æ–µ-–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π-–∫–æ–¥)

3. [–ß—Ç–æ —Ç–∞–∫–æ–µ GIL?–ö–∞–∫ –æ–Ω —É—Å—Ç—Ä–æ–µ–Ω](#3-—á—Ç–æ-—Ç–∞–∫–æ–µ-gil?–∫–∞–∫-–æ–Ω-—É—Å—Ç—Ä–æ–µ–Ω)

4. [–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—É —Ñ—É–Ω–∫—Ü–∏—è–º–∏ send, next, throw](#4-—á—Ç–æ-–ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç-–ø—Ä–∏-–æ–±—Ä–∞—â–µ–Ω–∏–∏-–∫-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—É-—Ñ—É–Ω–∫—Ü–∏—è–º–∏-send-next-throw)

5. [GIL —É—á–∞—Å—Ç–≤—É–µ—Ç –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ python –∫–æ–¥–∞](#5-gil-—É—á–∞—Å—Ç–≤—É–µ—Ç-–ø—Ä–∏-–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏-–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ-python-–∫–æ–¥–∞)
   
6. [–ú–æ–∂–Ω–æ –ª–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º—É–ª—å—Ç–∏–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –∏ asyncio](#6-–º–æ–∂–Ω–æ-–ª–∏-–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å-–º—É–ª—å—Ç–∏–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥-–∏-asyncio)
   
7. [–ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ü–∏–∫–ª —Å–æ–±—ã—Ç–∏–π (event loop) –≤ asyncio](#7-–≥–¥–µ-–Ω–∞—Ö–æ–¥–∏—Ç—Å—è-—Ü–∏–∫–ª-—Å–æ–±—ã—Ç–∏–π-(event-loop)-–≤-asyncio)
   
8. [–ó–∞—á–µ–º –Ω—É–∂–Ω—ã Future –≤ asyncio](#8-–∑–∞—á–µ–º-–Ω—É–∂–Ω—ã-future-–≤-asyncio)

---   

### 1) –ó–∞—á–µ–º –Ω–∞–º –Ω—É–∂–µ–Ω asyncio

asyncio ‚Äî —ç—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Python, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–π –∫–æ–¥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ—Ä—É—Ç–∏–Ω (async/await).

–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ I/O-bound –∑–∞–¥–∞—á–∞—Ö (—Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã, —Ä–∞–±–æ—Ç–∞ —Å –ë–î, —Ñ–∞–π–ª–∞–º–∏ –∏ —Ç. –¥.).

–ú–µ–Ω—å—à–∏–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ—Ç–æ–∫–∞–º–∏ (–Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤).

–ß–µ—Ç–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏, –≥–¥–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –û–° –º–æ–∂–µ—Ç –ø—Ä–µ—Ä—ã–≤–∞—Ç—å –ø–æ—Ç–æ–∫–∏ –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –º–æ–º–µ–Ω—Ç).

–ü—Ä–æ—Å—Ç–æ—Ç–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–≥–æ –∫–æ–¥–∞ (–ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å callback-–ø–æ–¥—Ö–æ–¥–æ–º –∏–ª–∏ —Ä—É—á–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–æ—Ç–æ–∫–∞–º–∏).

–ü—Ä–∏–º–µ—Ä:

```sh
import asyncio

async def fetch_data(url):
    print(f"–ó–∞–≥—Ä—É–∑–∫–∞ {url}...")
    await asyncio.sleep(2)  # –ò–º–∏—Ç–∞—Ü–∏—è I/O-–æ–ø–µ—Ä–∞—Ü–∏–∏
    return f"–î–∞–Ω–Ω—ã–µ —Å {url}"

async def main():
    task1 = asyncio.create_task(fetch_data("https://example.com"))
    task2 = asyncio.create_task(fetch_data("https://google.com"))
    await asyncio.gather(task1, task2)

asyncio.run(main())
```
–ó–¥–µ—Å—å –¥–≤–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ, –Ω–µ –±–ª–æ–∫–∏—Ä—É—è –¥—Ä—É–≥ –¥—Ä—É–≥–∞.


### 2) –ß—Ç–æ —Ç–∞–∫–æ–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ ‚Äî —ç—Ç–æ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∞ –º–æ–∂–µ—Ç –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –∏ –≤–æ–∑–æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö (–æ–±—ã—á–Ω–æ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞).

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ—Ä—É—Ç–∏–Ω—ã (—Ñ—É–Ω–∫—Ü–∏–∏ —Å async/await).

–†–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ (–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–º).

–ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫ –Ω–∞ –¥–æ–ª–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–∂–∏–¥–∞–Ω–∏–∏ –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞).

–£–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ü–∏–∫–ª–æ–º —Å–æ–±—ã—Ç–∏–π (event loop), –∫–æ—Ç–æ—Ä—ã–π —Ä–µ—à–∞–µ—Ç, –∫–∞–∫—É—é –∫–æ—Ä—É—Ç–∏–Ω—É –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–∞–ª—å—à–µ.

–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –∫–æ–¥–æ–º:

```sh
# –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ (–±–ª–æ–∫–∏—Ä—É—é—â–∏–π)
response = requests.get("https://example.com")  # –ñ–¥–µ—Ç –æ—Ç–≤–µ—Ç–∞
print(response.text)

# –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ (–Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π)
response = await aiohttp.get("https://example.com")  # –ú–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥—É—é –∑–∞–¥–∞—á—É
print(response.text)
```

### 3) –ß—Ç–æ —Ç–∞–∫–æ–µ GIL?–ö–∞–∫ –æ–Ω —É—Å—Ç—Ä–æ–µ–Ω

GIL (Global Interpreter Lock) ‚Äî —ç—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ –≤ CPython, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–º—É –ø–æ—Ç–æ–∫—É Python –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ (–¥–∞–∂–µ –Ω–∞ –º–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã—Ö CPU).

–ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω:

GIL ‚Äî —ç—Ç–æ –º—å—é—Ç–µ–∫—Å, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º Python-–∫–æ–¥–∞.

–ü–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å GIL, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å –±–∞–π—Ç-–∫–æ–¥ Python.

–ü–æ—Ç–æ–∫ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç GIL –ø—Ä–∏:

I/O-–æ–ø–µ—Ä–∞—Ü–∏—è—Ö (—á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞, —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã).

–í—ã–∑–æ–≤–µ C-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, NumPy –º–æ–∂–µ—Ç –æ—Ç–ø—É—Å–∫–∞—Ç—å GIL).

–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ (—á–µ—Ä–µ–∑ sys.setswitchinterval()).

–ü—Ä–æ–±–ª–µ–º—ã GIL:

–ù–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã–µ CPU –¥–ª—è CPU-bound –∑–∞–¥–∞—á (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã—á–∏—Å–ª–µ–Ω–∏–π).

–ó–∞–º–µ–¥–ª—è–µ—Ç –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –µ—Å–ª–∏ –æ–Ω–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç Python-–∫–æ–¥.

–û–±—Ö–æ–¥ GIL:

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º—É–ª—å—Ç–∏–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ—Å—Ç–∏ (multiprocessing).

–í—ã–Ω–æ—Å CPU-bound –∑–∞–¥–∞—á –≤ C-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ—Ç–æ–∫–æ–≤).

### 4) –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—É —Ñ—É–Ω–∫—Ü–∏—è–º–∏ send, next, throw

–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –≤ Python –º–æ–≥—É—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ —ç—Ç–∏ –º–µ—Ç–æ–¥—ã.

next(gen)

–ó–∞–ø—É—Å–∫–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä (–∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ yield).

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–µ –≤ yield.

–ï—Å–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∑–∞–≤–µ—Ä—à–µ–Ω, –≤—ã–∑—ã–≤–∞–µ—Ç StopIteration.

gen.send(value)

–ü–µ—Ä–µ–¥–∞–µ—Ç value –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä (—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º yield).

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞.

gen.throw(exc)

–í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ exc –≤ –º–µ—Å—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ yield.

–ï—Å–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –æ–Ω –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É.

–ü—Ä–∏–º–µ—Ä:
```sh
python
def my_gen():
    x = yield "–Ω–∞—á–∞–ª–æ"
    try:
        yield f"–ø–æ–ª—É—á–µ–Ω–æ: {x}"
    except ValueError:
        yield "–æ—à–∏–±–∫–∞!"

gen = my_gen()
print(next(gen))          # "–Ω–∞—á–∞–ª–æ"
print(gen.send(42))       # "–ø–æ–ª—É—á–µ–Ω–æ: 42"
print(gen.throw(ValueError))  # "–æ—à–∏–±–∫–∞!"
```

### 5) GIL —É—á–∞—Å—Ç–≤—É–µ—Ç –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ python –∫–æ–¥–∞

–î–∞, GIL —É—á–∞—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –º–µ—à–∞–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ:

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ (GIL –Ω–µ –º–µ—à–∞–µ—Ç, —Ç–∞–∫ –∫–∞–∫ –Ω–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ –ø–æ—Ç–æ–∫–æ–≤).

Event loop –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç GIL –Ω–∞ I/O-–æ–ø–µ—Ä–∞—Ü–∏—è—Ö, –ø–æ–∑–≤–æ–ª—è—è –¥—Ä—É–≥–∏–º –ø–æ—Ç–æ–∫–∞–º —Ä–∞–±–æ—Ç–∞—Ç—å.

–ö–æ—Ä—É—Ç–∏–Ω—ã –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ (—á–µ—Ä–µ–∑ await), –∞ –Ω–µ –≤—ã—Ç–µ—Å–Ω—è—é—Ç—Å—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ (–∫–∞–∫ –ø–æ—Ç–æ–∫–∏).

–í—ã–≤–æ–¥:
GIL –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–æ–π –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –∏ —Ç–∞–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ. –û–¥–Ω–∞–∫–æ –µ—Å–ª–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ä—É—Ç–∏–Ω –µ—Å—Ç—å CPU-bound –∫–æ–¥, –æ–Ω –º–æ–∂–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å event loop (–ø–æ—ç—Ç–æ–º—É CPU-bound –∑–∞–¥–∞—á–∏ –ª—É—á—à–µ –≤—ã–Ω–æ—Å–∏—Ç—å –≤ –ø—Ä–æ—Ü–µ—Å—Å—ã).

–ü—Ä–∏–º–µ—Ä:

```sh
async def cpu_bound_task():
    # –≠—Ç–æ—Ç –∫–æ–¥ –±—É–¥–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å event loop, –µ—Å–ª–∏ –æ–Ω CPU-bound!
    result = sum(i * i for i in range(10**6))
    return result

# –†–µ—à–µ–Ω–∏–µ: –≤—ã–Ω–µ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å (—á–µ—Ä–µ–∑ `asyncio.to_thread` –∏–ª–∏ `ProcessPoolExecutor`).
```

### 6) –ú–æ–∂–Ω–æ –ª–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º—É–ª—å—Ç–∏–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –∏ asyncio

–î–∞, –º–æ–∂–Ω–æ, –Ω–æ —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é.

–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
asyncio —É–ø—Ä–∞–≤–ª—è–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏ –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ (–æ–±—ã—á–Ω–æ –≤ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ).

multiprocessing –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–∫–∞–∂–¥—ã–π —Å–æ —Å–≤–æ–∏–º GIL –∏ —Å–≤–æ–∏–º event loop).

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```sh
import asyncio
from multiprocessing import Process

async def async_task(name):
    print(f"–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ {name} –∑–∞–ø—É—â–µ–Ω–∞")
    await asyncio.sleep(2)
    print(f"–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ {name} –∑–∞–≤–µ—Ä—à–µ–Ω–∞")

def run_async_loop():
    loop = asyncio.new_event_loop()
    asyncio.set_event_loop(loop)
    loop.run_until_complete(async_task("–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ"))

if __name__ == "__main__":
    # –ó–∞–ø—É—Å–∫–∞–µ–º –¥–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞, –≤ –∫–∞–∂–¥–æ–º —Å–≤–æ–π event loop
    p1 = Process(target=run_async_loop)
    p2 = Process(target=run_async_loop)
    p1.start()
    p2.start()
    p1.join()
    p2.join()
```

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

–ö–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏–º–µ–µ—Ç —Å–≤–æ–π event loop.

–í–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥.

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —è–¥–µ—Ä CPU (—Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã GIL).

–ü—Ä–æ–±–ª–µ–º—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
–û–±—â–∞—è –ø–∞–º—è—Ç—å –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ —Å–ª–æ–∂–Ω–∞ (–Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å multiprocessing.Queue, shared_memory –∏–ª–∏ IPC).

–ù–µ–ª—å–∑—è –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–æ—Ä—É—Ç–∏–Ω—ã –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ (—Ç–æ–ª—å–∫–æ –ø—Ä–∏–º–∏—Ç–∏–≤—ã: —á–∏—Å–ª–∞, —Å—Ç—Ä–æ–∫–∏, pickle-–æ–±—ä–µ–∫—Ç—ã).

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

–í—ã–≤–æ–¥:

–î–∞, –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ —ç—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –∫–æ–¥.

–õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å asyncio –¥–ª—è I/O-bound –∑–∞–¥–∞—á, –∞ multiprocessing –¥–ª—è CPU-bound –∑–∞–¥–∞—á.

### 7) –ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ü–∏–∫–ª —Å–æ–±—ã—Ç–∏–π (event loop) –≤ asyncio

—Ü–∏–∫–ª —Å–æ–±—ã—Ç–∏–π –≤—Å—Ç—Ä–æ–µ–Ω –≤ asyncio, –∏ –æ–±—ã—á–Ω–æ –æ–Ω —Å–∫—Ä—ã—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
–¶–∏–∫–ª —Å–æ–±—ã—Ç–∏–π ‚Äî —ç—Ç–æ "–¥–≤–∏–∂–æ–∫", –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∫–æ—Ä—É—Ç–∏–Ω.

–û–Ω –Ω–µ–≤–∏–¥–∏–º –≤ –∫–æ–¥–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ:

asyncio.run() –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç event loop.

–í–Ω—É—Ç—Ä–∏ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç loop.run_until_complete().

–ü—Ä–∏–º–µ—Ä —è–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```sh
import asyncio

async def my_task():
    print("–ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è")
    await asyncio.sleep(1)

# –°–æ–∑–¥–∞–µ–º event loop –≤—Ä—É—á–Ω—É—é (–æ–±—ã—á–Ω–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
loop = asyncio.new_event_loop()
asyncio.set_event_loop(loop)
loop.run_until_complete(my_task())
loop.close()  # –í–∞–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å, –µ—Å–ª–∏ —Å–æ–∑–¥–∞–ª–∏ –≤—Ä—É—á–Ω—É—é
```

–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å event loop –Ω–∞–ø—Ä—è–º—É—é?
–ï—Å–ª–∏ –≤—ã –ø–∏—à–µ—Ç–µ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–æ–∫–µ—Ç–∞–º–∏).

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å asyncio —Å –¥—Ä—É–≥–∏–º event loop (–Ω–∞–ø—Ä–∏–º–µ—Ä, uvloop –∏–ª–∏ Qt event loop).

–í—ã–≤–æ–¥:

–û–±—ã—á–Ω–æ –Ω–µ –Ω—É–∂–Ω–æ —Ç—Ä–æ–≥–∞—Ç—å event loop ‚Äî asyncio.run() –¥–µ–ª–∞–µ—Ç –≤—Å—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

–ù–æ –æ–Ω –µ—Å—Ç—å "–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º" –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∫–æ—Ä—É—Ç–∏–Ω.

### 8) –ó–∞—á–µ–º –Ω—É–∂–Ω—ã Future –≤ asyncio

Future ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—â—ë –Ω–µ—Ç.

–ê–Ω–∞–ª–æ–≥–∏—è:
Future ‚Äî —ç—Ç–æ –∫–∞–∫ "–æ–±–µ—â–∞–Ω–∏–µ" (promise), —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –ø–æ–∑–∂–µ.

–≠—Ç–æ –±–æ–ª–µ–µ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è, —á–µ–º –∫–æ—Ä—É—Ç–∏–Ω—ã (async/await).

–î–ª—è —á–µ–≥–æ –Ω—É–∂–Ω—ã:
–°–≤—è–∑—å –º–µ–∂–¥—É callback-—Å—Ç–∏–ª–µ–º –∏ async/await

–†–∞–Ω—å—à–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ –ø–∏—Å–∞–ª–∏ —Å –∫–æ–ª–±—ç–∫–∞–º–∏ (–∫–∞–∫ –≤ JavaScript –¥–æ Promise).

Future –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–µ—Ä–Ω—É—Ç—å –∫–æ–ª–±—ç–∫ –≤ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ await.

–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏

–ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å Future, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–∑–∂–µ —á–µ—Ä–µ–∑ set_result().

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç async/await

–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –µ—Å—Ç—å —Å—Ç–∞—Ä–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–∞ –∫–æ–ª–±—ç–∫–∞—Ö, –µ—ë –º–æ–∂–Ω–æ –æ–±–µ—Ä–Ω—É—Ç—å –≤ Future.

–ü—Ä–∏–º–µ—Ä:

```sh

import asyncio

async def set_future_result(fut):
    await asyncio.sleep(2)
    fut.set_result("–ì–æ—Ç–æ–≤–æ!")

async def main():
    # –°–æ–∑–¥–∞–µ–º Future –≤—Ä—É—á–Ω—É—é
    loop = asyncio.get_running_loop()
    fut = loop.create_future()

    # –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–¥–∞—á—É, –∫–æ—Ç–æ—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    asyncio.create_task(set_future_result(fut))

    # –ñ–¥–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    result = await fut
    print(result)  # "–ì–æ—Ç–æ–≤–æ!"

asyncio.run(main())
```

–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Future –∏ Task:
Task ‚Äî —ç—Ç–æ –ø–æ–¥–∫–ª–∞—Å—Å Future, –∫–æ—Ç–æ—Ä—ã–π –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç –∫–æ—Ä—É—Ç–∏–Ω—É –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ event loop.

Future ‚Äî –±–æ–ª–µ–µ –æ–±—â–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –≤—Ä—É—á–Ω—É—é.

–í—ã–≤–æ–¥:

–û–±—ã—á–Ω–æ –Ω–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å Future –≤—Ä—É—á–Ω—É—é (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ async/await).

–ù–æ –æ–Ω–∏ –ø–æ–ª–µ–∑–Ω—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å legacy-–∫–æ–¥–æ–º –∏–ª–∏ —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å—é.

–ò—Ç–æ–≥:
asyncio + multiprocessing ‚Üí –î–∞, –º–æ–∂–Ω–æ, –Ω–æ —Å–ª–æ–∂–Ω–æ.

Event loop ‚Üí –°–∫—Ä—ã—Ç –≤ asyncio, –Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é.

Future ‚Üí –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏.
